# np.column_stack np.vstack np.hstack

## 1. 函数概述

这三个函数的主要功能是将多个数组拼接成一个更大的数组，但拼接的方向和适用场景不同：

- **`np.column_stack`**：将 1D 或 2D 数组按**列**拼接，生成一个 2D 数组，适合将特征向量组合成特征矩阵。
- **`np.vstack`**：沿**垂直方向**（第 0 轴，行方向）拼接数组，适合堆叠样本。
- **`np.hstack`**：沿**水平方向**（第 1 轴，列方向）拼接数组，适合合并特征。

以下逐一介绍它们的定义、参数和作用。

---

## 2. 各函数的详细说明

### 2.1 `np.column_stack`

- **定义**：
  ```python
  np.column_stack(tup)
  ```
  - `tup`：要拼接的数组序列（可以是 1D 或 2D 数组）。
  - 返回：一个 2D 数组，输入数组作为列。

- **作用**：
  - 将多个 1D 数组作为列拼接成 2D 数组，或将多个 2D 数组按列拼接。
  - 特别适合将单独的特征向量组合成逻辑回归的特征矩阵 $\mathbf{X}$。

- **数学原理**：
  - 假设输入 $n$ 个 1D 数组，每个长度为 $m$，输出为形状 $(m, n)$ 的 2D 数组。
  - 例如，两个 1D 数组 $\mathbf{a} = [a_1, a_2, \dots, a_m]$ 和 $\mathbf{b} = [b_1, b_2, \dots, b_m]$，结果为：
    $
    \begin{bmatrix}
    a_1 & b_1 \\
    a_2 & b_2 \\
    \vdots & \vdots \\
    a_m & b_m
    \end{bmatrix}
    $
  - 对于 2D 数组，按列拼接，保持行数一致。

- **适用场景**：
  - 逻辑回归中，将多个特征（如年龄、收入）组合成特征矩阵。
  - 数据预处理中，将单独计算的特征向量合并。

- **注意事项**：
  - 1D 数组会自动视为列向量。
  - 输入数组的行数（或长度）必须一致。

### 2.2 `np.vstack`

- **定义**：
  ```python
  np.vstack(tup)
  ```
  - `tup`：要拼接的数组序列（可以是 1D 或 2D 数组）。
  - 返回：沿第 0 轴（行方向）拼接的数组。

- **作用**：
  - 将数组垂直堆叠，增加行数，保持列数一致。
  - 适合合并多个样本的特征矩阵或标签向量。

- **数学原理**：
  - 假设输入两个数组，形状分别为 $(m_1, n)$ 和 $(m_2, n)$，输出形状为 $(m_1 + m_2, n)$。
  - 例如，两个 2D 数组：
    $
    \mathbf{A} = \begin{bmatrix} a_{11} & a_{12} \\ a_{21} & a_{22} \end{bmatrix}, \quad
    \mathbf{B} = \begin{bmatrix} b_{11} & b_{12} \end{bmatrix}
    $
    结果为：
    $
    \begin{bmatrix}
    a_{11} & a_{12} \\
    a_{21} & a_{22} \\
    b_{11} & b_{12}
    \end{bmatrix}
    $
  - 1D 数组会先转换为 2D 数组（形状 $(1, n)$）。

- **适用场景**：
  - 逻辑回归中，合并来自不同来源的样本数据（如训练集和验证集）。
  - 批量追加样本行。

- **注意事项**：
  - 输入数组的列数必须一致。
  - 1D 数组会自动扩展为 2D（一行）。

### 2.3 `np.hstack`

- **定义**：
  ```python
  np.hstack(tup)
  ```
  - `tup`：要拼接的数组序列（可以是 1D 或 2D 数组）。
  - 返回：沿第 1 轴（列方向）拼接的数组。

- **作用**：
  - 将数组水平拼接，增加列数，保持行数一致。
  - 适合合并不同特征集。

- **数学原理**：
  - 假设输入两个数组，形状分别为 $(m, n_1)$ 和 $(m, n_2)$，输出形状为 $(m, n_1 + n_2)$。
  - 例如：
    $
    \mathbf{A} = \begin{bmatrix} a_{11} & a_{12} \\ a_{21} & a_{22} \end{bmatrix}, \quad
    \mathbf{B} = \begin{bmatrix} b_{11} \\ b_{21} \end{bmatrix}
    $
    结果为：
    $
    \begin{bmatrix}
    a_{11} & a_{12} & b_{11} \\
    a_{21} & a_{22} & b_{21}
    \end{bmatrix}
    $
  - 1D 数组视为行向量，拼接后增加列。

- **适用场景**：
  - 逻辑回归中，将新特征（例如多项式特征）添加到现有特征矩阵。
  - 合并不同类型的特征（如数值特征和编码后的类别特征）。

- **注意事项**：
  - 输入数组的行数必须一致。
  - 1D 数组视为单列或单行，需注意形状匹配。

---

## 3. 三者的对比

以下表格总结 `np.column_stack`、`np.vstack` 和 `np.hstack` 的差异：

| **特性**            | **np.column_stack**                       | **np.vstack**                           | **np.hstack**                           |
|---------------------|-------------------------------------------|-----------------------------------------|-----------------------------------------|
| **拼接方向**        | 按列（第 1 轴）                           | 按行（第 0 轴，垂直）                   | 按列（第 1 轴，水平）                   |
| **输出形状**        | $(m, n)$（$m$ 为输入长度，$n$ 为数组数） | $(m_1 + m_2, n)$                     | $(m, n_1 + n_2)$                     |
| **输入要求**        | 1D 数组长度一致，或 2D 数组行数一致       | 列数一致                                | 行数一致                                |
| **1D 数组处理**     | 视为列向量                                | 视为一行                                | 视为一行（列拼接）                      |
| **逻辑回归场景**    | 组合特征向量成特征矩阵                    | 合并样本（行）                          | 合并不同特征集（列）                    |
| **典型用途**        | 构造 $\mathbf{X}$（特征矩阵）           | 追加样本行                              | 扩展特征列                              |

---