ç»“åˆä½ çš„è¦æ±‚â€œknnåŸç†â€ï¼Œä»¥åŠä¹‹å‰çš„ä¸Šä¸‹æ–‡ï¼ˆKNN åˆ†ç±»ã€æ ·æœ¬ç±»åˆ«å‡è¡¡åŒ–ã€ç½®ä¿¡æ¦‚ç‡ã€æ”¯æŒå‘é‡æœºã€æœ´ç´ è´å¶æ–¯ç­‰ï¼‰ï¼Œæˆ‘å°†è¯¦ç»†è§£é‡Š **K è¿‘é‚»ï¼ˆK-Nearest Neighbors, KNNï¼‰** ç®—æ³•çš„åŸç†ï¼Œé‡ç‚¹é˜è¿°å…¶æ ¸å¿ƒæ¦‚å¿µã€æ•°å­¦åŸºç¡€ã€åˆ†ç±»ä¸å›å½’çš„å®ç°æ–¹å¼ï¼Œå¹¶å°†å…¶ä¸ `load_diabetes` æ•°æ®é›†çš„äºŒåˆ†ç±»ä»»åŠ¡ï¼ˆè½¬ä¸ºåˆ†ç±»é—®é¢˜ï¼‰è”ç³»èµ·æ¥ã€‚è§£é‡Šå°†æ¸…æ™°ç®€æ´ï¼Œé€‚åˆç†è§£ KNN åœ¨åˆ†ç±»ä»»åŠ¡ï¼ˆå¦‚ç»“åˆ SMOTE å’Œç½®ä¿¡æ¦‚ç‡ï¼‰ä¸­çš„åº”ç”¨ï¼ŒåŒæ—¶ä¸ä¹‹å‰çš„è®¨è®ºï¼ˆå¦‚æœ´ç´ è´å¶æ–¯ã€SVMã€RidgeCVï¼‰è¿›è¡Œå¯¹æ¯”ã€‚

### 1. KNN ç®—æ³•åŸç†æ¦‚è¿°
- **å®šä¹‰**ï¼šKNN æ˜¯ä¸€ç§åŸºäºå®ä¾‹çš„ã€éå‚æ•°çš„ç›‘ç£å­¦ä¹ ç®—æ³•ï¼Œç”¨äºåˆ†ç±»å’Œå›å½’ä»»åŠ¡ã€‚å®ƒçš„æ ¸å¿ƒæ€æƒ³æ˜¯â€œç‰©ä»¥ç±»èšâ€ï¼Œå³æ–°æ ·æœ¬çš„ç±»åˆ«ï¼ˆæˆ–å€¼ï¼‰ç”±å…¶ K ä¸ªæœ€è¿‘é‚»çš„ç±»åˆ«ï¼ˆæˆ–å€¼ï¼‰å†³å®šã€‚
- **å·¥ä½œæ–¹å¼**ï¼š
  - åˆ†ç±»ï¼šé€šè¿‡å¤šæ•°æŠ•ç¥¨ç¡®å®šæ–°æ ·æœ¬çš„ç±»åˆ«ã€‚
  - å›å½’ï¼šé€šè¿‡é‚»å±…ç›®æ ‡å€¼çš„å¹³å‡å€¼ï¼ˆæˆ–åŠ æƒå¹³å‡ï¼‰é¢„æµ‹æ–°æ ·æœ¬çš„å€¼ã€‚
- **ç‰¹ç‚¹**ï¼š
  - **æƒ°æ€§å­¦ä¹ **ï¼šæ²¡æœ‰æ˜¾å¼çš„è®­ç»ƒé˜¶æ®µï¼Œé¢„æµ‹æ—¶ç›´æ¥åŸºäºè®­ç»ƒæ•°æ®è®¡ç®—ã€‚
  - **éå‚æ•°**ï¼šä¸å‡è®¾æ•°æ®åˆ†å¸ƒï¼Œçµæ´»é€‚åº”å¤æ‚æ¨¡å¼ã€‚
  - **è·ç¦»ä¾èµ–**ï¼šä¾èµ–è·ç¦»åº¦é‡ï¼ˆå¦‚æ¬§å‡ é‡Œå¾—è·ç¦»ï¼‰ï¼Œå¯¹ç‰¹å¾å°ºåº¦æ•æ„Ÿã€‚
- **é€‚ç”¨åœºæ™¯**ï¼šå°è§„æ¨¡æ•°æ®é›†ã€å±€éƒ¨æ¨¡å¼æ˜æ˜¾çš„ä»»åŠ¡ï¼ˆå¦‚å›¾åƒåˆ†ç±»ã€æ¨èç³»ç»Ÿï¼‰ã€‚

### 2. KNN åˆ†ç±»åŸç†
#### 2.1 æ ¸å¿ƒæ­¥éª¤
KNN åˆ†ç±»çš„é¢„æµ‹è¿‡ç¨‹å¦‚ä¸‹ï¼š
1. **è®¡ç®—è·ç¦»**ï¼š
   - å¯¹æ–°æ ·æœ¬ $\mathbf{x}$ï¼Œè®¡ç®—å…¶ä¸è®­ç»ƒé›†ä¸­æ‰€æœ‰æ ·æœ¬ $\mathbf{x}_i$ çš„è·ç¦»ã€‚
   - å¸¸ç”¨è·ç¦»åº¦é‡ï¼š
     - æ¬§å‡ é‡Œå¾—è·ç¦»ï¼š$ \sqrt{\sum_{j=1}^n (x_j - x_{ij})^2} $
     - æ›¼å“ˆé¡¿è·ç¦»ï¼š$ \sum_{j=1}^n |x_j - x_{ij}| $
     - é—µå¯å¤«æ–¯åŸºè·ç¦»ç­‰ã€‚
2. **é€‰æ‹© K ä¸ªæœ€è¿‘é‚»**ï¼š
   - æ ¹æ®è·ç¦»æ’åºï¼Œé€‰æ‹©æœ€è¿‘çš„ K ä¸ªæ ·æœ¬ï¼ˆé‚»å±…ï¼‰ã€‚
3. **å¤šæ•°æŠ•ç¥¨**ï¼š
   - ç»Ÿè®¡ K ä¸ªé‚»å±…çš„ç±»åˆ«ï¼Œå¤šæ•°ç±»ä½œä¸ºæ–°æ ·æœ¬çš„é¢„æµ‹ç±»åˆ«ã€‚
   - å¦‚æœæœ‰å¹³å±€ï¼Œé€šå¸¸é€‰æ‹©è·ç¦»è¾ƒè¿‘çš„é‚»å±…æˆ–éšæœºæ‰“ç ´å¹³å±€ã€‚
4. **ç½®ä¿¡æ¦‚ç‡**ï¼š
   - ä½¿ç”¨ `predict_proba`ï¼Œæ¦‚ç‡ä¸º K ä¸ªé‚»å±…ä¸­æŸç±»åˆ«çš„æ¯”ä¾‹ã€‚ä¾‹å¦‚ï¼Œè‹¥ K=5ï¼Œ3 ä¸ªé‚»å±…å±äºç±»åˆ« 1ï¼Œåˆ™ $ P(\text{ç±»åˆ« 1}) = 3/5 = 0.6 $ã€‚

#### 2.2 æ•°å­¦è¡¨è¾¾
- **è·ç¦»è®¡ç®—**ï¼š
  $
  d(\mathbf{x}, \mathbf{x}_i) = \sqrt{\sum_{j=1}^n (x_j - x_{ij})^2}
  $
- **åˆ†ç±»å†³ç­–**ï¼š
  $
  \hat{y} = \arg\max_c \sum_{i \in N_K(\mathbf{x})} \mathbb{I}(y_i = c)
  $
  å…¶ä¸­ï¼š
  - $ N_K(\mathbf{x}) $ï¼šæ–°æ ·æœ¬ $\mathbf{x}$ çš„ K ä¸ªæœ€è¿‘é‚»ã€‚
  - $\mathbb{I}(y_i = c)$ï¼šæŒ‡ç¤ºå‡½æ•°ï¼Œè‹¥ $ y_i = c $ åˆ™ä¸º 1ï¼Œå¦åˆ™ä¸º 0ã€‚
- **æ¦‚ç‡è¾“å‡º**ï¼š
  $
  P(\text{ç±»åˆ« } c | \mathbf{x}) = \frac{\sum_{i \in N_K(\mathbf{x})} \mathbb{I}(y_i = c)}{K}
  $

#### 2.3 æƒé‡é€‰é¡¹
- **å‡åŒ€æƒé‡ï¼ˆ`weights='uniform'`ï¼‰**ï¼š
  - æ¯ä¸ªé‚»å±…çš„æŠ•ç¥¨æƒé‡ç›¸ç­‰ï¼Œå¤šæ•°ç±»è·èƒœã€‚
- **è·ç¦»åŠ æƒï¼ˆ`weights='distance'`ï¼‰**ï¼š
  - é‚»å±…çš„æŠ•ç¥¨æƒé‡ä¸è·ç¦»å€’æ•°æˆæ­£æ¯”ï¼š
    $
    w_i = \frac{1}{d(\mathbf{x}, \mathbf{x}_i)}
    $
  - è·ç¦»æ›´è¿‘çš„é‚»å±…å½±å“æ›´å¤§ï¼Œé€‚åˆæ•°æ®å¯†åº¦ä¸å‡çš„æƒ…å†µã€‚

### 3. KNN å›å½’åŸç†
- **ç›®æ ‡**ï¼šé¢„æµ‹è¿ç»­å€¼ï¼ŒåŸºäº K ä¸ªé‚»å±…ç›®æ ‡å€¼çš„å¹³å‡å€¼ã€‚
- **å…¬å¼**ï¼š
  - å‡åŒ€æƒé‡ï¼š
    $
    \hat{y} = \frac{1}{K} \sum_{i \in N_K(\mathbf{x})} y_i
    $
  - è·ç¦»åŠ æƒï¼š
    $
    \hat{y} = \frac{\sum_{i \in N_K(\mathbf{x})} w_i y_i}{\sum_{i \in N_K(\mathbf{x})} w_i}, \quad w_i = \frac{1}{d(\mathbf{x}, \mathbf{x}_i)}
    $
- **åº”ç”¨**ï¼š`load_diabetes` åŸå§‹æ˜¯å›å½’ä»»åŠ¡ï¼Œè‹¥ç›´æ¥ç”¨ KNN å›å½’ï¼Œå¯é¢„æµ‹ç–¾ç—…è¿›å±•å€¼ã€‚

### 4. KNN åœ¨ `load_diabetes` äºŒåˆ†ç±»ä»»åŠ¡ä¸­çš„åº”ç”¨
- **æ•°æ®é›†**ï¼š`load_diabetes` åŒ…å« 442 ä¸ªæ ·æœ¬ï¼Œ10 ä¸ªç‰¹å¾ï¼Œç›®æ ‡å€¼è½¬ä¸ºäºŒåˆ†ç±»ï¼ˆæŒ‰ä¸­ä½æ•°åˆ†ä¸ºä½/é«˜è¿›å±•ï¼‰ã€‚
- **KNN é€‚ç”¨æ€§**ï¼š
  - KNN é€‚åˆå°è§„æ¨¡æ•°æ®é›†ï¼ˆå¦‚ 442 æ ·æœ¬ï¼‰ï¼Œé€šè¿‡å±€éƒ¨é‚»å±…æ•æ‰ç‰¹å¾ä¸ç±»åˆ«çš„å…³ç³»ã€‚
  - å¯¹ä¸å¹³è¡¡æ•°æ®æ•æ„Ÿï¼Œéœ€ç»“åˆ SMOTE å‡è¡¡åŒ–ï¼ˆå¦‚ä¹‹å‰çš„ä»£ç ï¼‰ã€‚
- **ç½®ä¿¡æ¦‚ç‡**ï¼š
  - KNN çš„æ¦‚ç‡è¾“å‡ºåŸºäºé‚»å±…æ¯”ä¾‹ï¼Œç›´è§‚ä¸”ç›´æ¥ï¼Œé€‚åˆåˆ†æç±»åˆ«åˆ†å¸ƒã€‚
  - åœ¨å‡è¡¡åŒ–åï¼Œå°‘æ•°ç±»çš„æ¦‚ç‡åˆ†å¸ƒæ›´å‡åŒ€ï¼Œæ”¹å–„é¢„æµ‹æ€§èƒ½ã€‚
- **å­¦ä¹ æ›²çº¿**ï¼š
  - ä¹‹å‰çš„ä»£ç å±•ç¤ºäº† SMOTE å‡è¡¡åŒ–åï¼ŒéªŒè¯é›† F1 åˆ†æ•°æé«˜ï¼Œè¯´æ˜ KNN åœ¨å°‘æ•°ç±»ä¸Šçš„æ€§èƒ½å¢å¼ºã€‚

### 5. å…³é”®å‚æ•°ä¸è°ƒä¼˜
- **n_neighbors (K)**ï¼š
  - å° Kï¼šæ¨¡å‹å¤æ‚ï¼Œæ˜“è¿‡æ‹Ÿåˆï¼ˆå¯¹å™ªå£°æ•æ„Ÿï¼‰ã€‚
  - å¤§ Kï¼šæ¨¡å‹ç®€å•ï¼Œæ˜“æ¬ æ‹Ÿåˆï¼ˆå¹³æ»‘é¢„æµ‹ï¼‰ã€‚
  - éœ€é€šè¿‡äº¤å‰éªŒè¯é€‰æ‹©ï¼ˆå¦‚ç½‘æ ¼æœç´¢ï¼‰ã€‚
- **weights**ï¼š`uniform` é€‚åˆå‡åŒ€åˆ†å¸ƒæ•°æ®ï¼Œ`distance` é€‚åˆå¯†åº¦ä¸å‡ã€‚
- **metric**ï¼šé€šå¸¸ç”¨æ¬§å‡ é‡Œå¾—è·ç¦»ï¼Œä½†å¯å°è¯•å…¶ä»–è·ç¦»ï¼ˆå¦‚æ›¼å“ˆé¡¿è·ç¦»ï¼‰ã€‚
- **ç‰¹å¾å°ºåº¦**ï¼šKNN å¯¹ç‰¹å¾å°ºåº¦æ•æ„Ÿï¼Œéœ€æ ‡å‡†åŒ–ï¼ˆå¦‚ `StandardScaler`ï¼‰ã€‚

### 6. ä¸å…¶ä»–æ¨¡å‹çš„å¯¹æ¯”
ç»“åˆä¹‹å‰çš„è®¨è®ºï¼š
- **æœ´ç´ è´å¶æ–¯**ï¼š
  - å‡è®¾ç‰¹å¾æ¡ä»¶ç‹¬ç«‹ï¼Œæ¦‚ç‡åŸºäºåˆ†å¸ƒï¼ˆå¦‚é«˜æ–¯ã€ä¼¯åŠªåˆ©ï¼‰ï¼Œè®¡ç®—é«˜æ•ˆã€‚
  - KNN ä¸å‡è®¾åˆ†å¸ƒï¼Œç›´æ¥ç”¨è·ç¦»ï¼Œé€‚åˆå¤æ‚æ¨¡å¼ä½†è®¡ç®—æˆæœ¬é«˜ã€‚
- **æ”¯æŒå‘é‡æœºï¼ˆSVCï¼‰**ï¼š
  - é€šè¿‡æœ€å¤§åŒ–è¾¹ç•Œåˆ†ç±»ï¼Œæ¦‚ç‡éœ€ Platt ç¼©æ”¾ï¼Œé€‚åˆé«˜ç»´æ•°æ®ã€‚
  - KNN æ— è®­ç»ƒé˜¶æ®µï¼Œé¢„æµ‹æ—¶è®¡ç®—æ‰€æœ‰è·ç¦»ï¼Œé€‚åˆå°æ•°æ®é›†ä½†ä¸é€‚åˆé«˜ç»´ã€‚
- **RidgeCV/SVR**ï¼š
  - ç”¨äºå›å½’ä»»åŠ¡ï¼ŒRidge æ˜¯çº¿æ€§æ¨¡å‹ï¼ŒSVR ç”¨æ ¸å‡½æ•°å¤„ç†éçº¿æ€§ã€‚
  - KNN åˆ†ç±»ç›´æ¥ç”¨é‚»å±…æŠ•ç¥¨ï¼Œå›å½’ç”¨é‚»å±…å¹³å‡ï¼Œçµæ´»ä½†å¯¹å™ªå£°æ•æ„Ÿã€‚
- **æ ·æœ¬å‡è¡¡åŒ–ï¼ˆSMOTEï¼‰**ï¼š
  - KNN å¯¹ä¸å¹³è¡¡æ•°æ®æ•æ„Ÿï¼ŒSMOTE å‡è¡¡åŒ–æ˜¾è‘—æé«˜å°‘æ•°ç±» F1 åˆ†æ•°ï¼ˆå¦‚ä¹‹å‰çš„å­¦ä¹ æ›²çº¿ï¼‰ã€‚
- **ç½®ä¿¡æ¦‚ç‡**ï¼š
  - KNNï¼šæ¦‚ç‡æ˜¯é‚»å±…æ¯”ä¾‹ï¼Œç®€å•ç›´è§‚ã€‚
  - SVCï¼šæ¦‚ç‡é€šè¿‡ Platt ç¼©æ”¾ï¼Œå¯èƒ½æ›´å¹³æ»‘ä½†è®¡ç®—å¤æ‚ã€‚
  - æœ´ç´ è´å¶æ–¯ï¼šæ¦‚ç‡åŸºäºåˆ†å¸ƒå‡è®¾ï¼Œå¯èƒ½æ›´å‡†ç¡®ä½†ä¾èµ–åˆ†å¸ƒæ­£ç¡®æ€§ã€‚

### 7. KNN çš„ä¼˜ç¼ºç‚¹
- **ä¼˜ç‚¹**ï¼š
  - å®ç°ç®€å•ï¼Œæ— éœ€è®­ç»ƒï¼Œç›´æ¥åŸºäºæ•°æ®ã€‚
  - çµæ´»é€‚åº”éçº¿æ€§æ¨¡å¼ï¼Œå¤©ç„¶æ”¯æŒå¤šåˆ†ç±»ã€‚
  - æ¦‚ç‡è¾“å‡ºç›´è§‚ï¼Œæ˜“äºè§£é‡Šã€‚
- **ç¼ºç‚¹**ï¼š
  - é¢„æµ‹é˜¶æ®µè®¡ç®—å¤æ‚åº¦é«˜ï¼ˆO(n) æ¯æ¬¡é¢„æµ‹ï¼‰ã€‚
  - å¯¹ç‰¹å¾å°ºåº¦æ•æ„Ÿï¼Œéœ€æ ‡å‡†åŒ–ã€‚
  - å¯¹ä¸å¹³è¡¡æ•°æ®å’Œå™ªå£°æ•æ„Ÿï¼Œéœ€å‡è¡¡åŒ–æˆ–é¢„å¤„ç†ã€‚
  - ä¸é€‚åˆé«˜ç»´æˆ–å¤§è§„æ¨¡æ•°æ®ï¼ˆç»´åº¦ç¾éš¾ï¼‰ã€‚

### 8. æ”¹è¿›ä¹‹å‰ KNN ä»£ç ï¼ˆå¯é€‰ï¼‰
ä¸ºå¼ºåŒ– KNN åŸç†çš„ç†è§£ï¼Œå¯ä»¥ä¼˜åŒ–ä¹‹å‰çš„ä»£ç ï¼Œæ·»åŠ ç½‘æ ¼æœç´¢é€‰æ‹©æœ€ä¼˜ `n_neighbors`ï¼Œå¹¶å±•ç¤ºæ¦‚ç‡æ ¡å‡†æ›²çº¿ï¼š

```python
import numpy as np
import matplotlib.pyplot as plt
from sklearn.datasets import load_diabetes
from sklearn.neighbors import KNeighborsClassifier
from sklearn.model_selection import learning_curve, GridSearchCV
from sklearn.preprocessing import StandardScaler
from sklearn.metrics import f1_score
from imblearn.over_sampling import SMOTE
from sklearn.calibration import calibration_curve

# åŠ è½½ç³–å°¿ç—…æ•°æ®é›†
diabetes = load_diabetes()
X, y = diabetes.data, diabetes.target

# è½¬ä¸ºäºŒåˆ†ç±»
y_median = np.median(y)
y_binary = (y > y_median).astype(int)

# æ ‡å‡†åŒ–ç‰¹å¾
scaler = StandardScaler()
X = scaler.fit_transform(X)

# SMOTE å‡è¡¡åŒ–
smote = SMOTE(random_state=42)
X_balanced, y_balanced = smote.fit_resample(X, y_binary)
print("åŸå§‹ç±»åˆ«åˆ†å¸ƒ:", np.bincount(y_binary))
print("å‡è¡¡åç±»åˆ«åˆ†å¸ƒ:", np.bincount(y_balanced))

# ç½‘æ ¼æœç´¢ä¼˜åŒ– KNN å‚æ•°
param_grid = {'n_neighbors': [3, 5, 7, 9], 'weights': ['uniform', 'distance']}
grid = GridSearchCV(KNeighborsClassifier(), param_grid, cv=5, scoring='f1')
grid.fit(X_balanced, y_balanced)
knn = grid.best_estimator_
print(f"æœ€ä¼˜å‚æ•°: {grid.best_params_}")

# è·å–ç½®ä¿¡æ¦‚ç‡
knn.fit(X, y_binary)
probs_raw = knn.predict_proba(X)[:, 1]
knn.fit(X_balanced, y_balanced)
probs_bal = knn.predict_proba(X_balanced)[:, 1]

# è®¡ç®—å­¦ä¹ æ›²çº¿ï¼ˆå‡è¡¡åŒ–æ•°æ®ï¼‰
train_sizes = np.linspace(0.1, 1.0, 10)
train_sizes_bal, train_scores_bal, valid_scores_bal = learning_curve(
    knn, X_balanced, y_balanced, train_sizes=train_sizes, cv=5, scoring="f1", n_jobs=-1
)

# è®¡ç®— F1 åˆ†æ•°
train_f1_bal = train_scores_bal.mean(axis=1)
valid_f1_bal = valid_scores_bal.mean(axis=1)
train_f1_bal_std = train_scores_bal.std(axis=1)
valid_f1_bal_std = valid_scores_bal.std(axis=1)

# è®¡ç®—æ¦‚ç‡æ ¡å‡†æ›²çº¿
prob_true, prob_pred = calibration_curve(y_balanced, probs_bal, n_bins=10)

# åˆ›å»ºç”»å¸ƒ
fig = plt.figure(figsize=(12, 6))

# è‡ªç”±å¸ƒå±€ï¼šç½®ä¿¡æ¦‚ç‡åˆ†å¸ƒ
ax1 = fig.add_axes([0.1, 0.1, 0.35, 0.8])
ax1.hist(probs_bal[y_balanced == 0], bins=30, alpha=0.5, label='ç±»åˆ« 0', density=True)
ax1.hist(probs_bal[y_balanced == 1], bins=30, alpha=0.5, label='ç±»åˆ« 1', density=True)
ax1.set_xlabel('ç½®ä¿¡æ¦‚ç‡ (ç±»åˆ« 1)')
ax1.set_ylabel('å¯†åº¦')
ax1.set_title('KNN ç½®ä¿¡æ¦‚ç‡åˆ†å¸ƒ (SMOTE å‡è¡¡åŒ–)')
ax1.legend()
ax1.grid(True, ls="--")

# è‡ªç”±å¸ƒå±€ï¼šå­¦ä¹ æ›²çº¿
ax2 = fig.add_axes([0.55, 0.1, 0.35, 0.35])
ax2.plot(train_sizes_bal, train_f1_bal, 'b-', label='è®­ç»ƒé›† F1')
ax2.plot(train_sizes_bal, valid_f1_bal, 'r-', label='éªŒè¯é›† F1')
ax2.fill_between(train_sizes_bal, train_f1_bal - train_f1_bal_std, train_f1_bal + train_f1_bal_std, color='blue', alpha=0.1)
ax2.fill_between(train_sizes_bal, valid_f1_bal - valid_f1_bal_std, valid_f1_bal + valid_f1_bal_std, color='red', alpha=0.1)
ax2.set_xlabel('è®­ç»ƒæ ·æœ¬æ•°')
ax2.set_ylabel('F1 åˆ†æ•°')
ax2.set_title(f'KNN å­¦ä¹ æ›²çº¿ (k={knn.n_neighbors}, {knn.weights})')
ax2.legend()
ax2.grid(True, ls="--")

# è‡ªç”±å¸ƒå±€ï¼šæ¦‚ç‡æ ¡å‡†æ›²çº¿
ax3 = fig.add_axes([0.55, 0.55, 0.35, 0.35])
ax3.plot(prob_pred, prob_true, marker='o', label='æ ¡å‡†æ›²çº¿')
ax3.plot([0, 1], [0, 1], linestyle='--', label='ç†æƒ³æ ¡å‡†')
ax3.set_xlabel('é¢„æµ‹æ¦‚ç‡')
ax3.set_ylabel('å®é™…æ¦‚ç‡')
ax3.set_title('KNN æ¦‚ç‡æ ¡å‡†æ›²çº¿')
ax3.legend()
ax3.grid(True, ls="--")

plt.show()
```

### 9. ä»£ç æ”¹è¿›è¯´æ˜
- **ç½‘æ ¼æœç´¢**ï¼šä¼˜åŒ– `n_neighbors` å’Œ `weights`ï¼Œæé«˜ KNN æ€§èƒ½ã€‚
- **æ¦‚ç‡æ ¡å‡†æ›²çº¿**ï¼šæ–°å¢æ ¡å‡†æ›²çº¿ï¼Œè¯„ä¼° KNN ç½®ä¿¡æ¦‚ç‡çš„å¯é æ€§ï¼ˆç†æƒ³æƒ…å†µä¸‹ï¼Œé¢„æµ‹æ¦‚ç‡åº”æ¥è¿‘å®é™…æ¦‚ç‡ï¼‰ã€‚
- **ç®€åŒ–å¯è§†åŒ–**ï¼šä»…å±•ç¤ºå‡è¡¡åŒ–æ•°æ®çš„æ¦‚ç‡åˆ†å¸ƒå’Œå­¦ä¹ æ›²çº¿ï¼Œæ·»åŠ æ ¡å‡†æ›²çº¿ï¼Œä¿æŒè‡ªç”±å¸ƒå±€ã€‚

### 10. æ€»ç»“
- **KNN åŸç†**ï¼š
  - åˆ†ç±»ï¼šåŸºäº K ä¸ªæœ€è¿‘é‚»çš„å¤šæ•°æŠ•ç¥¨ï¼Œæ¦‚ç‡ä¸ºé‚»å±…æ¯”ä¾‹ã€‚
  - å›å½’ï¼šåŸºäºé‚»å±…ç›®æ ‡å€¼çš„å¹³å‡å€¼ã€‚
  - æ— è®­ç»ƒé˜¶æ®µï¼Œä¾èµ–è·ç¦»åº¦é‡ï¼Œéœ€æ ‡å‡†åŒ–ç‰¹å¾ã€‚


KNNï¼ˆK-Nearest Neighborsï¼Œ**Kè¿‘é‚»ç®—æ³•**ï¼‰æ˜¯ä¸€ç§**åŸºäºå®ä¾‹çš„ç›‘ç£å­¦ä¹ ç®—æ³•**ï¼Œå¸¸ç”¨äºåˆ†ç±»å’Œå›å½’ã€‚å®ƒæ˜¯æœ€ç®€å•ç›´è§‚ä½†éå¸¸å®ç”¨çš„æœºå™¨å­¦ä¹ ç®—æ³•ä¹‹ä¸€ã€‚

---

## ğŸ§  KNN åŸç†ï¼ˆä»¥åˆ†ç±»ä¸ºä¾‹ï¼‰

### 1ï¸âƒ£ æ€è·¯

- å¯¹äºä¸€ä¸ªå¾…åˆ†ç±»çš„æ ·æœ¬ç‚¹ $ x $ï¼ŒKNN ç®—æ³•ï¼š
  1. åœ¨è®­ç»ƒé›†ä¸­æ‰¾åˆ°è·ç¦» $ x $ æœ€è¿‘çš„ **K ä¸ªé‚»å±…**ã€‚
  2. çœ‹è¿™ K ä¸ªé‚»å±…ä¸­å“ªä¸ªç±»åˆ«æœ€å¤šã€‚
  3. å°† $ x $ åˆ†ä¸ºè¿™ä¸ªå‡ºç°æœ€å¤šçš„ç±»åˆ«ã€‚

---

### 2ï¸âƒ£ è·ç¦»åº¦é‡ï¼ˆå¸¸ç”¨ï¼‰

- **æ¬§æ°è·ç¦»**ï¼š
  $
  d(x, x_i) = \sqrt{\sum_{j=1}^{n} (x_j - x_{ij})^2}
  $
- æ›¼å“ˆé¡¿è·ç¦»ã€ä½™å¼¦è·ç¦»ä¹Ÿå¯é€‰

---

### 3ï¸âƒ£ K çš„é€‰æ‹©

- å°çš„ K å€¼ï¼šæ¨¡å‹å¯¹å™ªå£°æ•æ„Ÿï¼Œå®¹æ˜“è¿‡æ‹Ÿåˆ
- å¤§çš„ K å€¼ï¼šæ›´å¹³æ»‘ï¼Œä½†å¯èƒ½é”™è¿‡å±€éƒ¨ç»“æ„
- é€šå¸¸é€šè¿‡äº¤å‰éªŒè¯æ¥è°ƒå‚ï¼Œæ‰¾æœ€ä½³ K

---

### 4ï¸âƒ£ æƒé‡ç­–ç•¥ï¼ˆå¯é€‰ï¼‰

- é»˜è®¤æ¯ä¸ªé‚»å±…æƒé‡ç›¸ç­‰
- å¯æ”¹ä¸ºæŒ‰è·ç¦»åŠ æƒï¼Œç¦»å¾—è¿‘çš„é‚»å±…å½±å“æ›´å¤§ï¼š
  ```python
  KNeighborsClassifier(weights='distance')
  ```

---

## ğŸ“ˆ KNN ä¼˜ç‚¹

- ç®€å•æ˜“ç†è§£
- æ— éœ€è®­ç»ƒè¿‡ç¨‹ï¼Œé€‚åˆå°æ•°æ®é›†
- å¯¹å¤šåˆ†ç±»ä»»åŠ¡æ”¯æŒè‰¯å¥½

---

## âš ï¸ KNN ç¼ºç‚¹

- æ¨ç†æ…¢ï¼ˆæ¯æ¬¡éƒ½è¦ç®—æ‰€æœ‰ç‚¹è·ç¦»ï¼‰
- å¯¹é«˜ç»´æ•°æ®æ•ˆæœå·®ï¼ˆç»´åº¦ç¾éš¾ï¼‰
- å¯¹å°ºåº¦æ•æ„Ÿ â†’ éœ€è¦æ ‡å‡†åŒ–æˆ–å½’ä¸€åŒ–

---

## ğŸ§ª ç¤ºä¾‹ï¼ˆscikit-learnï¼‰

```python
from sklearn.neighbors import KNeighborsClassifier
from sklearn.datasets import load_iris
from sklearn.model_selection import train_test_split

iris = load_iris()
X_train, X_test, y_train, y_test = train_test_split(iris.data, iris.target)

knn = KNeighborsClassifier(n_neighbors=3)
knn.fit(X_train, y_train)

print(knn.score(X_test, y_test))  # è¾“å‡ºå‡†ç¡®ç‡
```




