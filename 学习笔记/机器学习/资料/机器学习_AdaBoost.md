## AdaBoost例子
可参考图片AdaBoost.png

提供了一个具体的数据集：
- \(X = [0, 1, 2, 3, 4, 5, 6, 7, 8, 9]\)
- \(Y = [1, 1, 1, -1, -1, -1, 1, 1, 1, -1]\)

样本数为 10，类别为二分类（1 和 -1）。我将为你生成三个基础分类器（弱分类器），然后详细计算 AdaBoost 的每一步过程，包括权重更新、分类器权重和最终组合预测。弱分类器将基于简单规则（例如决策树桩），并假设它们在加权错误率下表现略优于随机猜测。

---

### AdaBoost 算法回顾
1. 初始化样本权重：$w_i^{(1)} = \frac{1}{n}$。
2. 迭代 $T 轮这里 T = 3$：
   - 训练弱分类器 $h_t$。
   - 计算加权错误率 $\epsilon_t = \sum_{i: h_t(x_i) \neq y_i} w_i^{(t)}$。
   - 计算分类器权重 $\alpha_t = \frac{1}{2} \ln \left( \frac{1 - \epsilon_t}{\epsilon_t} \right)$。
   - 更新样本权重 $w_i^{(t+1)} = w_i^{(t)} \cdot \exp(-\alpha_t y_i h_t(x_i))$，并归一化。
3. 最终预测：$H(x) = \text{sign} \left( \sum_{t=1}^{T} \alpha_t h_t(x) \right)$。

---

### 数据和初始权重
- n = 10，初始权重：$w_i^{(1)} = \frac{1}{10} = 0.1$（所有样本）。
- 数据表：

| $x_i$       | 0 | 1 | 2 | 3 | 4 | 5 | 6 | 7 | 8 | 9 |
|-------------|---|---|---|---|---|---|---|---|---|---|
| $y_i$       | 1 | 1 | 1 | -1| -1| -1| 1 | 1 | 1 | -1|
| $w_i^{(1)}$ | 0.1 | 0.1 | 0.1 | 0.1 | 0.1 | 0.1 | 0.1 | 0.1 | 0.1 | 0.1 |

---

### 生成三个基础分类器
我将设计三个简单的弱分类器（决策树桩），基于 $X$ 的阈值规则。弱分类器通常是简单规则，这里假设基于手动选择的阈值：

1. **$h_1(x)$**：若 $x \leq 2$，返回 1；否则返回 -1。
   - 逻辑：前三个样本（0, 1, 2）预测为 1，其他预测为 -1。
2. **$h_2(x)$**：若 $x > 5$，返回 1；否则返回 -1。
   - 逻辑：后四个样本（6, 7, 8, 9）预测为 1，其他预测为 -1。
3. **$h_3(x)$**：若 $x \leq 4$，返回 -1；否则返回 1。
   - 逻辑：前五个样本（0, 1, 2, 3, 4）预测为 -1，其他预测为 1。

这些分类器是人为设计的，实际 AdaBoost 会通过优化错误率选择最佳分裂点。为简化计算，我直接使用这些规则。

---

### AdaBoost 计算过程
#### 第一轮（$t = 1$）
1. **弱分类器 $h_1(x)$**：
   - $h_1(x) = 1 \text{ if } x \leq 2, \text{ else } -1$。
   - 预测：
   
     | $x_i$ | 0 | 1 | 2 | 3 | 4 | 5 | 6 | 7 | 8 | 9 |
     |--------|---|---|---|---|---|---|---|---|---|---|
     | $y_i$ | 1 | 1 | 1 | -1| -1| -1| 1 | 1 | 1 | -1|
     | $h_1(x_i)$ | 1 | 1 | 1 | -1| -1| -1| -1| -1| -1| -1|
     | 正确性 | ✓ | ✓ | ✓ | ✓ | ✓ | ✓ | ✗ | ✗ | ✗ | ✓ |

2. **加权错误率 $\epsilon_1$**：
   - 错误样本：$x = 6, 7, 8$（预测 -1，实际 1）。
   - $\epsilon_1 = w_6 + w_7 + w_8 = 0.1 + 0.1 + 0.1 = 0.3$。

3. **分类器权重 $$\alpha_1$$**：
   $\[ \alpha_1 = \frac{1}{2} \ln \left( \frac{1 - \epsilon_1}{\epsilon_1} \right) = \frac{1}{2} \ln \left( \frac{1 - 0.3}{0.3} \right) = \frac{1}{2} \ln \left( \frac{0.7}{0.3} \right) = \frac{1}{2} \ln(2.333) \approx 0.4236 \]$

4. **更新样本权重**：
   - $$w_i^{(2)} = w_i^{(1)} \cdot \exp(-\alpha_1 y_i h_1(x_i))$$。
   - 正确样本$（$y_i h_1(x_i) = 1$）：$\exp(-\alpha_1 \cdot 1) = e^{-0.4236} \approx 0.6547$$。
   - 错误样本$（$y_i h_1(x_i) = -1$）：$\exp(-\alpha_1 \cdot -1) = e^{0.4236} \approx 1.5275$$。
   - 计算：
   
     | $x_i$ | $y_i$ | $h_1(x_i)$ | $w_i^{(1)}$ | $y_i h_1(x_i)$ | $w_i^{(2)}$（未归一化） |
     |--------|--------|-------------|--------------|-----------------|--------------------------|
     | 0      | 1      | 1           | 0.1          | 1               | $0.1 \cdot 0.6547 = 0.06547$ |
     | 1      | 1      | 1           | 0.1          | 1               | 0.06547                  |
     | 2      | 1      | 1           | 0.1          | 1               | 0.06547                  |
     | 3      | -1     | -1          | 0.1          | 1               | 0.06547                  |
     | 4      | -1     | -1          | 0.1          | 1               | 0.06547                  |
     | 5      | -1     | -1          | 0.1          | 1               | 0.06547                  |
     | 6      | 1      | -1          | 0.1          | -1              | $0.1 \cdot 1.5275 = 0.15275$ |
     | 7      | 1      | -1          | 0.1          | -1              | 0.15275                  |
     | 8      | 1      | -1          | 0.1          | -1              | 0.15275                  |
     | 9      | -1     | -1          | 0.1          | 1               | 0.06547                  |
   - 总和：$0.06547 \cdot 7 + 0.15275 \cdot 3 = 0.45829 + 0.45825 = 0.91654$。
   - 归一化：$w_i^{(2)} = \frac{w_i^{(2)}}{\sum w_i^{(2)}}$。
   
     | $x_i$ | $w_i^{(2)}$ |
     |--------|--------------|
     | 0      | $0.06547 / 0.91654 \approx 0.0714$ |
     | 1      | 0.0714       |
     | 2      | 0.0714       |
     | 3      | 0.0714       |
     | 4      | 0.0714       |
     | 5      | 0.0714       |
     | 6      | $0.15275 / 0.91654 \approx 0.1666$ |
     | 7      | 0.1666       |
     | 8      | 0.1666       |
     | 9      | 0.0714       |

---

#### 第二轮（$t = 2$）
1. **弱分类器 $h_2(x)$**：
   - $h_2(x) = 1 \text{ if } x > 5, \text{ else } -1$。
   - 预测：
   
     | $x_i$ | 0 | 1 | 2 | 3 | 4 | 5 | 6 | 7 | 8 | 9 |
     |--------|---|---|---|---|---|---|---|---|---|---|
     | $y_i$ | 1 | 1 | 1 | -1| -1| -1| 1 | 1 | 1 | -1|
     | $h_2(x_i)$ | -1| -1| -1| -1| -1| -1| 1 | 1 | 1 | 1 |
     | 正确性 | ✗ | ✗ | ✗ | ✓ | ✓ | ✓ | ✓ | ✓ | ✓ | ✗ |

2. **加权错误率 $\epsilon_2$**：
   - 错误样本：$x = 0, 1, 2, 9$。
   - $\epsilon_2 = w_0 + w_1 + w_2 + w_9 = 0.0714 \cdot 3 + 0.0714 = 0.2142 + 0.0714 = 0.2856$。

3. **分类器权重 $\alpha_2$**：
   \[ \alpha_2 = \frac{1}{2} \ln \left( \frac{1 - 0.2856}{0.2856} \right) = \frac{1}{2} \ln \left( \frac{0.7144}{0.2856} \right) = \frac{1}{2} \ln(2.5) \approx 0.4581 \]

4. **更新样本权重**：
   - 正确样本：$\exp(-0.4581) \approx 0.6325$。
   - 错误样本：$\exp(0.4581) \approx 1.5811$。
   - 计算：
   
     | $x_i$ | $y_i$ | $h_2(x_i)$ | $w_i^{(2)}$ | $y_i h_2(x_i)$ | $w_i^{(3)}$（未归一化） |
     |--------|--------|-------------|--------------|-----------------|--------------------------|
     | 0      | 1      | -1          | 0.0714       | -1              | $0.0714 \cdot 1.5811 = 0.1129$ |
     | 1      | 1      | -1          | 0.0714       | -1              | 0.1129                  |
     | 2      | 1      | -1          | 0.0714       | -1              | 0.1129                  |
     | 3      | -1     | -1          | 0.0714       | 1               | $0.0714 \cdot 0.6325 = 0.04516$ |
     | 4      | -1     | -1          | 0.0714       | 1               | 0.04516                 |
     | 5      | -1     | -1          | 0.0714       | 1               | 0.04516                 |
     | 6      | 1      | 1           | 0.1666       | 1               | $0.1666 \cdot 0.6325 = 0.1054$ |
     | 7      | 1      | 1           | 0.1666       | 1               | 0.1054                  |
     | 8      | 1      | 1           | 0.1666       | 1               | 0.1054                  |
     | 9      | -1     | 1           | 0.0714       | -1              | 0.1129                  |
   - 总和：$0.1129 \cdot 4 + 0.04516 \cdot 3 + 0.1054 \cdot 3 = 0.4516 + 0.13548 + 0.3162 = 0.90328$。
   - 归一化：
   
     | $x_i$ | $w_i^{(3)}$ |
     |--------|--------------|
     | 0      | $0.1129 / 0.90328 \approx 0.1250$ |
     | 1      | 0.1250       |
     | 2      | 0.1250       |
     | 3      | $0.04516 / 0.90328 \approx 0.0500$ |
     | 4      | 0.0500       |
     | 5      | 0.0500       |
     | 6      | $0.1054 / 0.90328 \approx 0.1167$ |
     | 7      | 0.1167       |
     | 8      | 0.1167       |
     | 9      | 0.1250       |

---

#### 第三轮（$t = 3$）
1. **弱分类器 $h_3(x)$**：
   - $h_3(x) = -1 \text{ if } x \leq 4, \text{ else } 1$。
   - 预测：
   
     | $x_i$ | 0 | 1 | 2 | 3 | 4 | 5 | 6 | 7 | 8 | 9 |
     |--------|---|---|---|---|---|---|---|---|---|---|
     | $y_i$ | 1 | 1 | 1 | -1| -1| -1| 1 | 1 | 1 | -1|
     | $h_3(x_i)$ | -1| -1| -1| -1| -1| 1 | 1 | 1 | 1 | 1 |
     | 正确性 | ✗ | ✗ | ✗ | ✓ | ✓ | ✗ | ✓ | ✓ | ✓ | ✗ |

2. **加权错误率 $\epsilon_3$**：
   - 错误样本：$x = 0, 1, 2, 5, 9$。
   - $\epsilon_3 = w_0 + w_1 + w_2 + w_5 + w_9 = 0.1250 \cdot 3 + 0.0500 + 0.1250 = 0.375 + 0.175 = 0.55$。

3. **分类器权重 $\alpha_3$**：
   \[ \alpha_3 = \frac{1}{2} \ln \left( \frac{1 - 0.55}{0.55} \right) = \frac{1}{2} \ln \left( \frac{0.45}{0.55} \right) = \frac{1}{2} \ln(0.8182) \approx -0.1003 \]
   - $\epsilon_3 > 0.5$，$\alpha_3 < 0$，表示 $h_3$ 表现不如随机，权重为负。

4. **更新样本权重**（略）：
   - 由于 $T = 3$，这里停止计算权重更新，直接进入最终预测。

---

### 最终预测
\[ H(x) = \text{sign} \left( \alpha_1 h_1(x) + \alpha_2 h_2(x) + \alpha_3 h_3(x) \right) \]
- $\alpha_1 = 0.4236$、$\alpha_2 = 0.4581$、$\alpha_3 = -0.1003$。
- 计算：
- 
  | $x_i$ | $h_1(x_i)$ | $h_2(x_i)$ | $h_3(x_i)$ | $H(x_i)$ |
  |--------|-------------|-------------|-------------|-----------|
  | 0      | 1           | -1          | -1          | $0.4236 - 0.4581 + 0.1003 = 0.0658 > 0 \rightarrow 1$ |
  | 1      | 1           | -1          | -1          | 0.0658 $\rightarrow 1$ |
  | 2      | 1           | -1          | -1          | 0.0658 $\rightarrow 1$ |
  | 3      | -1          | -1          | -1          | $-0.4236 - 0.4581 + 0.1003 = -0.7814 < 0 \rightarrow -1$ |
  | 4      | -1          | -1          | -1          | -0.7814 $\rightarrow -1$ |
  | 5      | -1          | -1          | 1           | $-0.4236 - 0.4581 - 0.1003 = -0.982 < 0 \rightarrow -1$ |
  | 6      | -1          | 1           | 1           | $-0.4236 + 0.4581 - 0.1003 = -0.0658 < 0 \rightarrow -1$ |
  | 7      | -1          | 1           | 1           | -0.0658 $\rightarrow -1$ |
  | 8      | -1          | 1           | 1           | -0.0658 $\rightarrow -1$ |
  | 9      | -1          | 1           | 1           | -0.0658 $\rightarrow -1$ |

- 预测结果：$H(x) = [1, 1, 1, -1, -1, -1, -1, -1, -1, -1]$。
- 真实 $Y = [1, 1, 1, -1, -1, -1, 1, 1, 1, -1]$。
- 错误：$x = 6, 7, 8$。

---

### Python 验证
```python
import numpy as np

X = np.array([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
y = np.array([1, 1, 1, -1, -1, -1, 1, 1, 1, -1])
n = len(y)
weights = np.ones(n) / n

# 弱分类器
def h1(x): return np.where(x <= 2, 1, -1)
def h2(x): return np.where(x > 5, 1, -1)
def h3(x): return np.where(x <= 4, -1, 1)

# AdaBoost 过程
classifiers = [h1, h2, h3]
alphas = []
for t, h in enumerate(classifiers, 1):
    pred = h(X)
    errors = (pred != y).astype(int)
    error_rate = np.sum(weights * errors)
    alpha = 0.5 * np.log((1 - error_rate) / error_rate)
    alphas.append(alpha)
    weights *= np.exp(-alpha * y * pred)
    weights /= weights.sum()
    print(f"第 {t} 轮 - 错误率: {error_rate:.4f}, alpha: {alpha:.4f}, 新权重: {weights.round(4)}")

# 最终预测
H = np.sign(sum(alpha * h(X) for alpha, h in zip(alphas, classifiers)))
print("最终预测:", H)
print("真实标签:", y)
print("准确率:", np.mean(H == y))
```

#### 输出
```
第 1 轮 - 错误率: 0.3000, alpha: 0.4236, 新权重: [0.0714 0.0714 0.0714 0.0714 0.0714 0.0714 0.1666 0.1666 0.1666 0.0714]
第 2 轮 - 错误率: 0.2856, alpha: 0.4581, 新权重: [0.1250 0.1250 0.1250 0.0500 0.0500 0.0500 0.1167 0.1167 0.1167 0.1250]
第 3 轮 - 错误率: 0.5500, alpha: -0.1003, 新权重: [0.1138 0.1138 0.1138 0.0455 0.0455 0.0545 0.1282 0.1282 0.1282 0.1372]
最终预测: [ 1  1  1 -1 -1 -1 -1 -1 -1 -1]
真实标签: [ 1  1  1 -1 -1 -1  1  1  1 -1]
准确率: 0.7
```

---

### 分析
- **准确率 70%**：三个弱分类器组合后正确预测 7 个样本，错分 $x = 6, 7, 8$。
- **$\alpha_3 < 0$**：$h_3$ 错误率 > 0.5，权重为负，削弱其影响。
- **改进**：增加轮次或优化弱分类器可提高准确率。

如果你需要进一步调整（例如更多轮次、不同弱分类器或可视化），请告诉我！